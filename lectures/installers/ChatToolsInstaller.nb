(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15088,        352]
NotebookOptionsPosition[     14599,        331]
NotebookOutlinePosition[     15068,        351]
CellTagsIndexPosition[     15025,        348]
WindowTitle->ChatToolsInstaller
WindowFrame->Palette*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 TagBox[GridBox[{
    {
     InterpretationBox[Cell["",
       FontSize->11,ExpressionUUID->"fff10992-2e37-49a7-9a24-a7124e086f53"],
      TextCell["", FontSize -> 11]]},
    {Cell[BoxData[
      ButtonBox[
       RowBox[{"Install", " ", "Package"}],
       Appearance->Automatic,
       ButtonData->{
         CloudObject[
         "https://www.wolframcloud.com/objects/d4e52924-3170-4d76-98e6-\
d44682f3e967"], 
         CloudObject[
         "https://www.wolframcloud.com/objects/ac783402-2b3b-45d2-9934-\
7f15795304d1"], 
         CloudObject[
         "https://www.wolframcloud.com/objects/da6fb5a6-d31c-49be-976e-\
12dca8cc560c"], 
         CloudObject[
         "https://www.wolframcloud.com/objects/cf8b656f-d91b-4ab3-a149-\
477237007010"], 
         CloudObject[
         "https://www.wolframcloud.com/objects/66497ad4-5b8a-43a4-9e7a-\
7d5c7ae88b3c"]},
       ButtonFunction:>(
        Module[{$CellContext`cfmDir = 
          FileNameJoin[{$UserBaseDirectory, "Autoload", 
             "ChatFrameworkMenus"}], $CellContext`cftDir = 
          FileNameJoin[{$UserBaseDirectory, "Applications", 
             "ChatFrameworkTools"}], $CellContext`btnb = 
          ButtonNotebook[], $CellContext`smnb, $CellContext`app = 
          FileNameJoin[{$UserBaseDirectory, 
             "Applications"}], $CellContext`aut = 
          FileNameJoin[{$UserBaseDirectory, 
             "Autoload"}], $CellContext`arc, $CellContext`ph = 
          "PublicHelp", $CellContext`pha = 
          "PublicHelpAdmin", $CellContext`phm = 
          "PublicHelpMenus", $CellContext`ct = "ChatTools", $CellContext`ctm = 
          "ChatToolsMenus", $CellContext`progDialog1, \
$CellContext`progDialog2}, If[
           DirectoryQ[$CellContext`cfmDir], 
           DeleteDirectory[$CellContext`cfmDir, DeleteContents -> True]]; If[
           DirectoryQ[$CellContext`cftDir], 
           DeleteDirectory[$CellContext`cftDir, DeleteContents -> True]]; 
         Function[$CellContext`t, 
           If[
            And[$CellContext`t =!= {}, 
             DirectoryQ[
              Part[$CellContext`t, 1]]], 
            DeleteDirectory[
             Part[$CellContext`t, 1], DeleteContents -> True]]][
           FileNames[
            StringExpression["ChatFrameworkTools", 
             BlankSequence[]], {
             
             FileNameJoin[{
              PacletManager`$UserBasePacletsDirectory, "Repository"}]}]]; 
         Map[If[
            DirectoryQ[#], 
            DeleteDirectory[#, DeleteContents -> True]]& , 
           Map[
           FileNameJoin[{$CellContext`aut, #}]& , {$CellContext`ph, \
$CellContext`pha, $CellContext`ct}]]; Map[NotebookClose, 
           Select[
            Notebooks[], Or[
             
             MemberQ[{
              "ChannelListener", "ChooseAQuestionToAnswer", 
               "DisplayChatsSaved"}, 
              CurrentValue[#, {TaggingRules, "Dialog"}]], 
             CurrentValue[#, WindowTitle] === "PublicHelpAdmin"]& ]]; 
         ChatTools`prog = 0; Catch[If[
             Or[
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`ph}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`pha}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`aut, $CellContext`phm}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`ct}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`aut, $CellContext`ctm}]]], 
             If[
              MatchQ[
               ChoiceDialog[
               "A version of ChatTools is already installed. Do you wish to \
overwrite the existing version?", {"Overwrite" :> (Quiet[
                    DeleteDirectory[
                    FileNameJoin[{$CellContext`app, $CellContext`ph}], 
                    DeleteContents -> True], 
                    MessageName[DeleteDirectory, "nodir"]]; Quiet[
                    DeleteDirectory[
                    FileNameJoin[{$CellContext`app, $CellContext`pha}], 
                    DeleteContents -> True], 
                    MessageName[DeleteDirectory, "nodir"]]; Quiet[
                    DeleteDirectory[
                    FileNameJoin[{$CellContext`aut, $CellContext`phm}], 
                    DeleteContents -> True], 
                    MessageName[DeleteDirectory, "nodir"]]; Quiet[
                    DeleteDirectory[
                    FileNameJoin[{$CellContext`app, $CellContext`ct}], 
                    DeleteContents -> True], 
                    MessageName[DeleteDirectory, "nodir"]]; Quiet[
                    DeleteDirectory[
                    FileNameJoin[{$CellContext`aut, $CellContext`ctm}], 
                    DeleteContents -> True], 
                    MessageName[DeleteDirectory, "nodir"]]), 
                 "Cancel" :> $Canceled}, WindowTitle -> 
                "Previous Installation", WindowFloating -> True], $Canceled], 
              Throw[$Canceled]]]; $CellContext`progDialog1 = CreateDialog[
              Column[{
                Style[
                 TextCell["Installing ChatTools..."], 12], 
                ProgressIndicator[
                Appearance -> "Indeterminate", ImageSize -> 120], 
                TextCell[""]}, Alignment -> Center], WindowFloating -> True, 
              WindowSize -> FitAll]; $CellContext`progDialog2 = CreateDialog[
              Column[{
                Style[
                 TextCell["Installing ChatTools..."], 12], 
                Style[
                 TextCell["Installing Prerequisites..."], 11], 
                ProgressIndicator[
                 Dynamic[ChatTools`prog], ImageSize -> 120], 
                TextCell[""]}, Alignment -> Center], WindowFloating -> True, 
              WindowSize -> FitAll]; $CellContext`smnb = NotebookPut[
              Notebook[{
                Cell[
                 BoxData[
                 "PacletUpdate[\"ChannelFramework\", \
\"UpdateSites\"->True];"], "Input"], 
                Cell[
                 BoxData["ChatTools`prog=0.2;"], "Input"], 
                Cell[
                 BoxData["SendMessage;$CloudConnected;"], "Input"], 
                Cell[
                 BoxData["ChatTools`prog=0.4;"], "Input"], 
                Cell[
                 BoxData["CloudConnect[\"RememberMe\"->True];"], "Input"], 
                Cell[
                 BoxData["ChatTools`prog=0.75;"], "Input"], 
                Cell[
                 BoxData["SendMessage;"], "Input"], 
                Cell[
                 BoxData["ChatTools`prog=1;"], "Input"]}, Visible -> False]]; 
           NotebookEvaluate[$CellContext`smnb]; 
           NotebookClose[$CellContext`smnb]; 
           NotebookClose[$CellContext`progDialog2]; $CellContext`arc = 
            FileNameJoin[{$CellContext`app, "ChatTools.zip"}]; CopyFile[
             Part[#, 4], $CellContext`arc]; 
           ExtractArchive[$CellContext`arc, $CellContext`app]; 
           DeleteFile[$CellContext`arc]; $CellContext`arc = 
            FileNameJoin[{$CellContext`aut, "ChatToolsMenus.zip"}]; CopyFile[
             Part[#, 5], $CellContext`arc]; 
           ExtractArchive[$CellContext`arc, $CellContext`aut]; 
           DeleteFile[$CellContext`arc]; 
           NotebookClose[$CellContext`progDialog1]; MessageDialog[
             StringJoin[
             "Installation almost complete \[LongDash] please restart ", \
$ProgramName, " to complete the ChatTools installation."], WindowFloating -> 
             True]]; NotebookClose[$CellContext`btnb]; Null]& ),
       Evaluator->Automatic,
       FrameMargins->14,
       ImageSize->160,
       Method->"Queued"]],ExpressionUUID->
      "e9b80c38-5ef5-438d-908e-0b5e8721b301"]},
    {Cell[BoxData[
      ButtonBox[
       RowBox[{"Uninstall", " ", "Package"}],
       Appearance->Automatic,
       ButtonFunction:>(
        Module[{$CellContext`cfmDir = 
          FileNameJoin[{$UserBaseDirectory, "Autoload", 
             "ChatFrameworkMenus"}], $CellContext`cftDir = 
          FileNameJoin[{$UserBaseDirectory, "Applications", 
             "ChatFrameworkTools"}], $CellContext`btnb = 
          ButtonNotebook[], $CellContext`smnb, $CellContext`app = 
          FileNameJoin[{$UserBaseDirectory, 
             "Applications"}], $CellContext`aut = 
          FileNameJoin[{$UserBaseDirectory, 
             "Autoload"}], $CellContext`arc, $CellContext`ph = 
          "PublicHelp", $CellContext`pha = 
          "PublicHelpAdmin", $CellContext`phm = 
          "PublicHelpMenus", $CellContext`ct = "ChatTools", $CellContext`ctm = 
          "ChatToolsMenus", $CellContext`progDialog1, \
$CellContext`progDialog2}, If[
           DirectoryQ[$CellContext`cfmDir], 
           DeleteDirectory[$CellContext`cfmDir, DeleteContents -> True]]; If[
           DirectoryQ[$CellContext`cftDir], 
           DeleteDirectory[$CellContext`cftDir, DeleteContents -> True]]; 
         Function[$CellContext`t, 
           If[
            And[$CellContext`t =!= {}, 
             DirectoryQ[
              Part[$CellContext`t, 1]]], 
            DeleteDirectory[
             Part[$CellContext`t, 1], DeleteContents -> True]]][
           FileNames[
            StringExpression["ChatFrameworkTools", 
             BlankSequence[]], {
             
             FileNameJoin[{
              PacletManager`$UserBasePacletsDirectory, "Repository"}]}]]; 
         Map[If[
            DirectoryQ[#], 
            DeleteDirectory[#, DeleteContents -> True]]& , 
           Map[
           FileNameJoin[{$CellContext`aut, #}]& , {$CellContext`ph, \
$CellContext`pha, $CellContext`ct}]]; Map[NotebookClose, 
           Select[
            Notebooks[], Or[
             
             MemberQ[{
              "ChannelListener", "ChooseAQuestionToAnswer", 
               "DisplayChatsSaved"}, 
              CurrentValue[#, {TaggingRules, "Dialog"}]], 
             CurrentValue[#, WindowTitle] === "PublicHelpAdmin"]& ]]; 
         ChatTools`prog = 0; Catch[If[
             Or[
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`ph}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`pha}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`aut, $CellContext`phm}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`app, $CellContext`ct}]], 
              DirectoryQ[
               FileNameJoin[{$CellContext`aut, $CellContext`ctm}]]], Quiet[
               DeleteDirectory[
                FileNameJoin[{$CellContext`app, $CellContext`ph}], 
                DeleteContents -> True], 
               MessageName[DeleteDirectory, "nodir"]]; Quiet[
               DeleteDirectory[
                FileNameJoin[{$CellContext`app, $CellContext`pha}], 
                DeleteContents -> True], 
               MessageName[DeleteDirectory, "nodir"]]; Quiet[
               DeleteDirectory[
                FileNameJoin[{$CellContext`aut, $CellContext`phm}], 
                DeleteContents -> True], 
               MessageName[DeleteDirectory, "nodir"]]; Quiet[
               DeleteDirectory[
                FileNameJoin[{$CellContext`app, $CellContext`ct}], 
                DeleteContents -> True], 
               MessageName[DeleteDirectory, "nodir"]]; Quiet[
               DeleteDirectory[
                FileNameJoin[{$CellContext`aut, $CellContext`ctm}], 
                DeleteContents -> True], 
               MessageName[DeleteDirectory, "nodir"]], 
             Throw[
              MessageDialog[
              "ChatTools is not present.", WindowFrame -> 
               "ModalDialog"]]]; $CellContext`progDialog1 = CreateDialog[
              Column[{
                Style[
                 TextCell["Uninstalling ChatTools..."], 12], 
                ProgressIndicator[
                Appearance -> "Indeterminate", ImageSize -> 120], 
                TextCell[""]}, Alignment -> Center], WindowFloating -> True, 
              WindowSize -> FitAll]; $CellContext`progDialog2 = CreateDialog[
              Column[{
                Style[
                 TextCell["Uninstalling ChatTools..."], 12], 
                ProgressIndicator[
                 Dynamic[ChatTools`prog], ImageSize -> 120], 
                TextCell[""]}, Alignment -> Center], WindowFloating -> True, 
              WindowSize -> FitAll]; $CellContext`smnb = NotebookPut[
              Notebook[{
                Cell[
                 BoxData["PublicHelp`prog=0.4;"], "Input"], 
                Cell[
                 BoxData["PublicHelp`prog=0.75;"], "Input"], 
                Cell[
                 BoxData["PublicHelp`prog=1;"], "Input"]}, Visible -> False]]; 
           NotebookEvaluate[$CellContext`smnb]; 
           NotebookClose[$CellContext`smnb]; 
           NotebookClose[$CellContext`progDialog2]; 
           NotebookClose[$CellContext`progDialog1]; MessageDialog[
             StringJoin[
             "Uninstall almost complete \[LongDash] please restart ", \
$ProgramName, " to complete the ChatTools uninstall."], WindowFloating -> 
             True]]; NotebookClose[$CellContext`btnb]; Null]& ),
       Evaluator->Automatic,
       FrameMargins->7,
       ImageSize->160,
       Method->"Queued"]],ExpressionUUID->
      "2b7358a7-7839-485a-a13d-2462c91ed001"]}
   },
   AutoDelete->False,
   GridBoxAlignment->{"Columns" -> {{Center}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{1}}}],
  "Grid"]],
 CellMargins->{{0, 0}, {0, 0}},
 CellBracketOptions->{"Color"->RGBColor[0.269993, 0.308507, 0.6]},
 CellHorizontalScrolling->True,
 PageBreakAbove->True,
 PageBreakWithin->False,
 ShowAutoStyles->True,
 LineSpacing->{1.25, 0},
 AutoItalicWords->{},
 ScriptMinSize->9,
 ShowStringCharacters->False,
 FontFamily:>CurrentValue["PanelFontFamily"],
 FontSize:>CurrentValue[
  "PanelFontSize"],ExpressionUUID->"1437f2f1-e91c-44ad-b736-6052967fcf30"]
},
Saveable->False,
WindowSize->{200, 160},
WindowMargins->{{Automatic, Automatic}, {Automatic, Automatic}},
WindowElements->{},
WindowTitle->"ChatToolsInstaller",
DockedCells->{},
TextAlignment->Center,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Palette.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[591, 21, 14004, 308, 128, InheritFromParent, "ExpressionUUID" -> \
"1437f2f1-e91c-44ad-b736-6052967fcf30",
 PageBreakAbove->True,
 PageBreakWithin->False]
}
]
*)

(* End of internal cache information *)

